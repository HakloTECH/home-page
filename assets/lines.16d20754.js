const v=.1,c="0, 255, 233",y=40,f=1,m="rgb(0,0,0)",{PI:h,random:n,cos:l,sin:d}=Math,o=[0,h/2,h,h/2*3,h/4,h/4*3,h/4*5,h/4*7];class g{constructor(i){this.canvas=i;this.init()}prevTurnPoint=[];x;dir;y;width;v;vx;vy;fadeout;opacity;color;init(){this.prevTurnPoint=[];const i=n();i<.25?(this.x=n()*this.canvas.width,this.dir=o[1],this.y=0):i<.5?(this.x=n()*this.canvas.width,this.dir=o[3],this.y=this.canvas.height):i<.75?(this.x=0,this.dir=o[0],this.y=n()*this.canvas.height):(this.x=this.canvas.width,this.dir=o[2],this.y=n()*this.canvas.height),this.prevTurnPoint.push({x:this.x,y:this.y}),this.width=f,this.v=y,this.vx=this.v*l(this.dir),this.vy=this.v*d(this.dir),this.fadeout=!1,this.opacity=n()**.2,this.color=`rgba(${c}, ${this.opacity})`}draw(i){this.fadeout?this.opacity<.1?this.init():(this.opacity*=.9,this.color=`rgba(${c}, ${this.opacity})`):(this.outOfScreen(),this.x+=this.vx,this.y+=this.vy,n()<v&&this.turn()),i.strokeStyle=this.color,i.lineWidth=this.width,i.beginPath(),i.moveTo(this.x,this.y);for(let s=this.prevTurnPoint.length-1;s>=0;s--){const t=this.prevTurnPoint[s];i.lineTo(t.x,t.y)}i.stroke(),i.closePath()}turn(){const i=o.filter(s=>{let t=Math.abs(this.dir-s);return t>h&&(t=2*h-t),t<=h/2});this.dir=i[n()*i.length^0],this.vx=this.v*l(this.dir),this.vy=this.v*d(this.dir),this.prevTurnPoint.push({x:this.x,y:this.y})}outOfScreen(){(this.x>=this.canvas.width&&this.vx>0||this.y>=this.canvas.height&&this.vy>0||this.x<=0&&this.vx<0||this.y<=0&&this.vy<0)&&(this.fadeout=!0)}}const p=e=>{const{canvas:i}=e,s=[];let t;const u=Math.min(i.width*i.height*1e-5,20);for(let r=0;r<u;r++)s.push(new g(i));function a(){e.clearRect(0,0,i.width,i.height),e.fillStyle=m,e.fillRect(0,0,i.width,i.height);for(let r=s.length;r--;)s[r].draw(e);t=requestAnimationFrame(a)}return t=requestAnimationFrame(a),{dispose:()=>{cancelAnimationFrame(t),s.length=0}}};export const painters={"2d":{init:p}};
